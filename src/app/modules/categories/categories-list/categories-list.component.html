<app-page-header>
  <!-- Card stats -->
  <div class="row">
    <div class="col-12 text-right">
      <a routerLink="/categories/add" class="btn btn-primary">
        Add New Category
      </a>
    </div>
  </div>
</app-page-header>
<!-- Page content -->
<div class="container-fluid mt--7">
  <!-- Table -->
  <div class="row justify-content-center">
    <div class="col-xl-6">
      <div class="card shadow">
        <div class="card-header border-0">
          <h3 class="mb-0">All Categories</h3>
        </div>

        <!-- new table start -->
        <div class="card-body pt-0">
          <div class="categories_outer">
            <ng-container *ngFor="let category of categories">
              <ng-template [ngTemplateOutlet]="displayCategory"
                [ngTemplateOutletContext]="{ category: category }"></ng-template>
            </ng-container>
          </div>
        </div>


        <ng-template #displayCategory let-category="category">
          <div class="cat_list">
            <ul class="pl-0">
              <li class="dropdown-fixed parent-item">
                <span (click)="toggleRow(category)"> <i
                    [class]="category.show ? 'fa fa-chevron-down' : 'fa fa-chevron-right'"
                    *ngIf="category.subcategories.length"></i> {{ category.name }} </span>
                <div ngbDropdown>
                  <a class="btn btn-sm btn-icon-only text-primary" ngbDropdownToggle>
                    <i class="fas fa-ellipsis-v"></i>
                  </a>
                  <div ngbDropdownMenu class="dropdown-menu-right dropdown-menu-arrow">
                    <a (click)="deleteCategory(category.id, 1)" class="dropdown-item" href="javascript:void(0)">
                      Delete category
                    </a>
                    <a class="dropdown-item" [routerLink]="'/categories/edit/' + category.id">
                      Edit category
                    </a>
                  </div>
                </div>
              </li>
            </ul>
            <ul class="child-item">
              <!-- <td  *ngIf="!category.subcategories || category.subcategories.length === 0"></td> -->
              <li [@collapse]="category.show ? 'open' : 'closed'" *ngIf="category.subcategories">
                <ng-container *ngIf="category.subcategories">
                  <ng-container *ngFor="let subcategory of category.subcategories">
                    <ng-template [ngTemplateOutlet]="displayCategory"
                      [ngTemplateOutletContext]="{ category: subcategory }"></ng-template>
                  </ng-container>
                </ng-container>
                <!-- </td> -->
              </li>
            </ul>
          </div>

        </ng-template>

        <!-- new table end -->
      </div>
    </div>
  </div>
</div>
